/*! angular-promise-button v0.1.0 */;!function(){var a=angular.module("promise-button",["promise-button-templates"]);a.constant("STATES",{IDLE:"idle",LOADING:"loading",INTERMEDIATE:"intermediate",DONE:"done",FAILED:"failed"})}(),function(){var a=angular.module("promise-button");a.directive("promiseDefault",function(){return{scope:!1,restrict:"E",templateUrl:"directives/promise-default.tpl.html",transclude:!0}})}(),function(){var a=angular.module("promise-button");a.directive("whenProgress",["ngIfDirective","STATES",function(a,b){var c=a[0];return{transclude:c.transclude,priority:c.priority-1,terminal:c.terminal,restrict:c.restrict,require:"^promiseButton",link:function(a,d,e,f){var g,h=e.whenProgress;g=h?function(){return f.status==b.INTERMEDIATE&&f.state==a.$eval(h)}:function(){return f.status==b.INTERMEDIATE||f.status==b.LOADING};var i,j=e.ngIf;i=j?function(){return a.$eval(j)&&g()}:function(){return g()},e.ngIf=i,c.link.apply(c,arguments)}}}])}(),function(){var a=angular.module("promise-button");a.directive("whenPromise",["ngIfDirective","STATES",function(a,b){var c=a[0];return{transclude:c.transclude,priority:c.priority-1,terminal:c.terminal,restrict:c.restrict,require:"^promiseButton",link:function(a,d,e,f){var g,h=e.whenPromise;g=h?function(){return f.status==h}:function(){return f.status!=b.IDLE};var i,j=e.ngIf;i=j?function(){return a.$eval(j)&&g()}:function(){return g()},e.ngIf=i,c.link.apply(c,arguments)}}}])}(),function(){var a=angular.module("promise-button");a.controller("PromiseButtonController",["$scope","STATES","$timeout",function(a,b,c){var d=this;d.action=null;var e=this,f=function(c,d){switch(e.status=c,a.status=c,c){case b.INTERMEDIATE:case b.DONE:case b.FAILED:a.state=d,e.state=d;break;default:delete e.state,delete a.state}};f(b.IDLE),d.startAction=function(){if(a.status==b.IDLE&&d.action){f(b.LOADING);var e=function(a){return function(d){f(a,d),c(function(){f(b.IDLE)},500)}},g=function(a){f(b.INTERMEDIATE,a)};return a.$apply(),d.action(a).then(e(b.DONE),e(b.FAILED),g)}}}])}(),function(){var a=angular.module("promise-button");a.directive("promiseButton",["$parse",function(a){return{controller:"PromiseButtonController",restrict:"A",compile:function(b,c){var d=a(c.promiseButton,null,!0);return function(a,b,c,e){e.action=d;var f=c.promiseTrigger||"click";b.bind(f,e.startAction)}}}}])}(),angular.module("promise-button-templates",["directives/promise-default.tpl.html"]),angular.module("directives/promise-default.tpl.html",[]).run(["$templateCache",function(a){a.put("directives/promise-default.tpl.html",'<span ng-transclude when-promise="idle"></span>\n<i class="fa fa-refresh fa-spin" when-progress></i>\n<i class="fa fa-check" when-promise="done"></i>\n<i class="fa fa-times" when-promise="failed"></i>')}]);